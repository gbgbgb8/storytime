<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Text Adventure Game</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* FAB styles */
    .fab-menu {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      z-index: 1000;
    }

    .fab-button {
      border-radius: 50%;
    }

    .fab-controls {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body class="bg-dark text-white">
  <div id="fab-menu" class="fab-menu">
    <button id="fab-button" class="btn btn-dark fab-button">‚ò∞</button>
    <div id="fab-controls" class="fab-controls hidden">
      <button id="mode-toggle" class="btn btn-dark">üåó</button>
      <button id="goto-maker" class="btn btn-dark" onclick="window.location.href='makejson.html'">‚ùì</button>
      <select id="story-select" class="form-select bg-dark text-white">
      </select>
    </div>
  </div>
  <div class="container my-4">
    <div class="row">
      <div class="col-12 col-md-6">
        <div class="card bg-secondary">
          <img id="game-image" src="" alt="Game Image" class="card-img-top">
        </div>
      </div>
      <div class="col-12 col-md-6">
        <div class="card bg-secondary">
          <div class="card-header">üìñ</div>
          <div id="narrative-text" class="card-body">
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer class="bg-secondary text-center py-2">
    <div id="options-container">
      <button id="optionA" class="btn btn-dark mx-2"></button>
      <button id="optionB" class="btn btn-dark mx-2"></button>
    </div>
  </footer>
  <script>
    // Populate story dropdown dynamically
    async function populateStories() {
        const stories = ['default', 'catonabeach', 'example1'];
        const selectElement = document.getElementById('story-select');
        stories.forEach(story => {
          const option = document.createElement('option');
          option.text = story;
          option.value = story;
          selectElement.appendChild(option);
        });
        loadStory(stories[0]);
      }

    // Load a selected story
    async function loadStory(storyName) {
        const response = await fetch(`stories/${storyName}/story.json`);
        const gameData = await response.json();

        function updatePage(pageNumber) {
          const pageData = gameData.pages[pageNumber];
          document.getElementById('game-image').src = getRandomImage(pageNumber);
          document.getElementById('narrative-text').innerHTML = pageData.text;
          document.getElementById('optionA').innerText = pageData.options[0].text;
          document.getElementById('optionB').innerText = pageData.options[1].text;
          document.getElementById('optionA').onclick = () => updatePage(pageData.options[0].nextPage);
          document.getElementById('optionB').onclick = () => updatePage(pageData.options[1].nextPage);
        }

        updatePage("1");
      }

    // Toggle FAB menu visibility
    document.getElementById('fab-button').addEventListener('click', function() {
        const controls = document.getElementById('fab-controls');
        controls.classList.toggle('hidden');
    });

    // Populate stories and initialize
    populateStories();
  </script>
</body>
</html>
