<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Make JSON for Text Adventure Game</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.8/spectre.min.css">
  <style>
    body {
      background-color: #222;
      color: #fff;
    }
    .page {
      margin-bottom: 20px;
      border: 1px solid #444;
      padding: 10px;
      border-radius: 8px;
    }
    h1, h2 {
      color: #fff;
    }
  </style>
</head>
<body>
  <h1>Create JSON for Text Adventure Game</h1>
  <form id="json-form">
    <div id="pages">
    </div>
    <button type="button" id="add-page" class="btn">Add Page</button><br>
    <button type="button" id="generate-json" class="btn">Generate JSON</button><br>
    <input type="file" id="import-json" accept=".json">
    <button type="button" id="import-button" class="btn">Import JSON</button>
  </form>
  <h2>Generated JSON:</h2>
  <pre id="json-output"></pre>
  <button type="button" id="copy-json" class="btn">Copy JSON</button>
  <script>
    function addPage(i, data = {}) {
      const newPage = document.createElement('div');
      newPage.className = 'page';
      newPage.id = `page-${i}`;
      newPage.innerHTML = `
        <h2>Page ${i}</h2>
        <label>Narrative Text: <textarea name="text-${i}">${data.text || ''}</textarea></label><br>
        <label>Setting: <input type="text" name="setting-${i}" value="${data.metadata?.Setting || ''}"></label><br>
        <label>Time: <input type="text" name="time-${i}" value="${data.metadata?.Time || ''}"></label><br>
        <label>Option A Text: <textarea name="optionA-${i}">${data.options?.[0]?.text || ''}</textarea></label><br>
        <label>Option A Next Page: <input type="text" name="optionA-next-${i}" value="${data.options?.[0]?.nextPage || ''}"></label><br>
        <label>Option B Text: <textarea name="optionB-${i}">${data.options?.[1]?.text || ''}</textarea></label><br>
        <label>Option B Next Page: <input type="text" name="optionB-next-${i}" value="${data.options?.[1]?.nextPage || ''}"></label><br>
      `;
      document.getElementById('pages').appendChild(newPage);
    }
    addPage(1);
    document.getElementById('add-page').addEventListener('click', function() {
      const nextPage = document.querySelectorAll('.page').length + 1;
      addPage(nextPage);
    });
    document.getElementById('generate-json').addEventListener('click', function() {
      const jsonData = { pages: {} };
      for (const pageDiv of document.querySelectorAll('.page')) {
        const i = pageDiv.id.split('-')[1];
        const form = document.forms['json-form'];
        jsonData.pages[i] = {
          text: form[`text-${i}`].value,
          metadata: {
            Setting: form[`setting-${i}`].value,
            Time: form[`time-${i}`].value
          },
          options: [
            {
              text: form[`optionA-${i}`].value,
              nextPage: form[`optionA-next-${i}`].value
            },
            {
              text: form[`optionB-${i}`].value,
              nextPage: form[`optionB-next-${i}`].value
            }
          ]
        };
      }
      document.getElementById('json-output').textContent = JSON.stringify(jsonData, null, 2);
    });
    document.getElementById('import-button').addEventListener('click', function() {
      const fileInput = document.getElementById('import-json');
      const file = fileInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const jsonData = JSON.parse(e.target.result);
          document.getElementById('pages').innerHTML = '';
          for (const [i, data] of Object.entries(jsonData.pages)) {
            addPage(i, data);
          }
        };
        reader.readAsText(file);
      }
    });
    document.getElementById('copy-json').addEventListener('click', function() {
      const jsonText = document.getElementById('json-output').textContent;
      navigator.clipboard.writeText(jsonText).then(function() {
        alert('JSON copied to clipboard');
      }).catch(function(err) {
        alert('Could not copy JSON: ', err);
      });
    });
  </script>
</body>
</html>
